# TodoTool 手动测试流程

> Phase 7 功能验收测试清单

---

## 测试准备

1. 构建并运行应用
```bash
cd /Users/w4ynewang/Documents/code/todo_tool
xcodebuild -scheme TodoTool -configuration Debug build
open ~/Library/Developer/Xcode/DerivedData/TodoTool-*/Build/Products/Debug/TodoTool.app
```

2. 清空测试数据（可选）
```bash
rm -rf ~/Library/Application\ Support/TodoTool/data.json*
```

---

## 一、基础功能测试

### 1.1 新建任务
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击右上角 `+` 按钮或按 `⌘N` | 弹出新建任务对话框 |
| 2 | 输入 "测试任务1" 并按 Enter | 任务出现在列表顶部 |
| 3 | 重复创建 5 个任务 | 列表显示 5 个任务，最新在最上 |
| 4 | 尝试提交空标题 | 按钮禁用或无响应 |

### 1.2 完成状态切换
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击任务左侧空心圆 | 变为绿色勾选，任务移至「已完成」分组 |
| 2 | 再次点击勾选圆 | 变为空心圆，任务返回「待办」分组 |
| 3 | 选中任务后按 `⌘Enter` | 状态切换 |

### 1.3 删除任务
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 向左滑动任务行 | 显示删除按钮 |
| 2 | 点击删除 | 任务从列表移除 |
| 3 | 选中任务后按 `⌘⌫` | 任务删除 |

### 1.4 行内编辑
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 双击任务标题 | 进入编辑模式，显示蓝色边框 |
| 2 | 修改标题后按 Enter | 保存修改，退出编辑 |
| 3 | 按 Esc | 取消修改，恢复原标题 |
| 4 | 清空标题后按 Enter | 任务被删除 |

---

## 二、Phase 7.1 深色模式

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 菜单栏 → 视图 → 外观 → 深色 | 应用切换为深色主题 |
| 2 | 菜单栏 → 视图 → 外观 → 浅色 | 应用切换为浅色主题 |
| 3 | 菜单栏 → 视图 → 外观 → 跟随系统 | 跟随系统设置 |
| 4 | 退出并重新打开应用 | 外观偏好保留 |

**验证点**：
- [ ] 所有文字在深色模式下可读
- [ ] 优先级圆点颜色正确显示
- [ ] 搜索框背景适配深色模式

---

## 三、Phase 7.2 搜索过滤

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 按 `⌘F` | 搜索框获得焦点 |
| 2 | 输入 "测试" | 列表实时过滤，只显示包含"测试"的任务 |
| 3 | 输入不存在的关键词 | 显示"无搜索结果"提示 |
| 4 | 点击清除按钮（×） | 搜索框清空，显示全部任务 |
| 5 | 按 Esc | 清空搜索并取消焦点 |

---

## 四、Phase 7.3 优先级标记

### 4.1 设置优先级
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击任务最左侧的灰色圆点 | 弹出优先级菜单 |
| 2 | 选择「高优先级」 | 圆点变为红色 |
| 3 | 选择「中优先级」 | 圆点变为橙色 |
| 4 | 选择「低优先级」 | 圆点变为蓝色 |
| 5 | 选择「无优先级」 | 圆点变为灰色 |

### 4.2 优先级排序
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 创建 4 个任务，分别设置不同优先级 | - |
| 2 | 观察列表顺序 | 高 → 中 → 低 → 无 |

### 4.3 快捷键设置优先级
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 选中任务，按 `⌘0` | 无优先级 |
| 2 | 按 `⌘1` | 低优先级 |
| 3 | 按 `⌘2` | 中优先级 |
| 4 | 按 `⌘3` | 高优先级 |

### 4.4 优先级过滤
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击搜索框旁的筛选器按钮 | 显示优先级过滤菜单 |
| 2 | 选择「高优先级」 | 只显示高优先级任务 |
| 3 | 选择「全部」 | 显示所有任务 |

---

## 五、Phase 7.4 导入/导出

### 5.1 导出
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 按 `⌘E` 或 菜单 → 文件 → 导出数据… | 弹出保存对话框 |
| 2 | 选择位置并保存 | 生成 `TodoTool_Export_*.json` 文件 |
| 3 | 打开导出的文件 | JSON 格式正确，包含所有任务 |

### 5.2 导入（覆盖模式）
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 创建几个新任务 | - |
| 2 | 按 `⌘I` 或 菜单 → 文件 → 导入数据… | 弹出文件选择对话框 |
| 3 | 选择之前导出的文件 | 弹出模式选择对话框 |
| 4 | 选择「覆盖」 | 现有任务被替换为导入的任务 |

### 5.3 导入（合并模式）
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 创建一个新任务 "独有任务" | - |
| 2 | 导入之前的文件，选择「合并」 | 显示 "新增 X 条，跳过 Y 条" |
| 3 | 检查列表 | "独有任务" 保留，导入的新任务添加 |

---

## 六、Phase 7.5 撤销/重做

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 创建任务 "撤销测试" | 任务出现 |
| 2 | 按 `⌘Z` | 任务消失（撤销添加） |
| 3 | 按 `⌘⇧Z` | 任务恢复（重做添加） |
| 4 | 删除任务后按 `⌘Z` | 任务恢复 |
| 5 | 修改标题后按 `⌘Z` | 标题恢复 |
| 6 | 切换完成状态后按 `⌘Z` | 状态恢复 |

---

## 七、Phase 7.6 统计面板

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 观察窗口底部状态栏 | 显示 "待办: X | 已完成: Y | 今日完成: Z" |
| 2 | 添加任务 | 待办计数 +1 |
| 3 | 完成任务 | 待办 -1，已完成 +1，今日完成 +1 |
| 4 | 删除已完成任务 | 已完成计数 -1 |

---

## 八、Phase 7.7 到期日期

### 8.1 设置到期日期
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 右键点击任务 | 显示上下文菜单 |
| 2 | 设置到期日期 → 今天 | 任务行显示 "今天" 标签 |
| 3 | 设置到期日期 → 明天 | 显示 "明天" 标签 |
| 4 | 设置到期日期 → 下周 | 显示具体日期 |
| 5 | 设置到期日期 → 清除 | 日期标签消失 |

### 8.2 到期状态颜色
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 设置到期日期为今天 | 橙色标签（即将到期） |
| 2 | 设置到期日期为昨天（需手动修改数据或等待） | 红色标签 + 感叹号（已过期） |
| 3 | 完成已过期任务 | 到期日期标签消失 |

---

## 九、Phase 7.8 拖拽排序

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 创建 3 个同优先级任务：A、B、C | 显示顺序 A、B、C |
| 2 | 长按 C 并拖动到 A 上方 | 顺序变为 C、A、B |
| 3 | 退出并重新打开应用 | 顺序保持 C、A、B |
| 4 | 在「已完成」分组内拖拽 | 同样支持排序 |

**注意**：不同优先级的任务会按优先级分组显示，拖拽只在同优先级内生效。

---

## 十、Phase 7.9 批量操作

### 10.1 多选
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 按住 ⌘ 点击多个任务 | 多个任务被选中（高亮） |
| 2 | 按住 ⇧ 点击范围 | 范围内任务全部选中 |

### 10.2 批量操作工具栏
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 选中 2+ 个任务 | 底部显示批量操作工具栏 |
| 2 | 点击「删除」 | 所有选中任务删除 |
| 3 | 选中多个待办任务，点击「标记完成」 | 全部变为已完成 |
| 4 | 选中多个任务，点击优先级按钮 | 批量设置优先级 |

### 10.3 清除已完成
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 完成几个任务 | 「已完成」分组有任务 |
| 2 | 按 `⌘⇧K` 或 菜单 → 编辑 → 清除已完成 | 所有已完成任务被删除 |

---

## 十一、Phase 7.10 标签分类

### 11.1 创建标签
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 按 `⌘⇧T` 或 菜单 → 编辑 → 管理标签… | 弹出标签管理 Sheet |
| 2 | 输入标签名 "工作" | - |
| 3 | 选择颜色（如蓝色） | - |
| 4 | 点击「添加」 | 标签出现在列表中 |
| 5 | 重复创建 "生活"（绿色）、"学习"（紫色） | 3 个标签 |

### 11.2 为任务添加标签
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 右键点击任务 | 显示上下文菜单 |
| 2 | 标签 → 工作 | 任务行显示蓝色 "工作" 徽章 |
| 3 | 再次右键 → 标签 → 生活 | 显示两个徽章 |
| 4 | 右键 → 标签 → 工作（已勾选） | 取消 "工作" 标签 |

### 11.3 标签显示
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 为任务添加 4 个标签 | 显示前 3 个徽章 + "+1" |
| 2 | 观察徽章颜色 | 与标签颜色一致 |

### 11.4 按标签过滤
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击筛选器按钮 | 显示过滤菜单 |
| 2 | 选择「工作」标签 | 只显示带 "工作" 标签的任务 |
| 3 | 选择「全部」 | 显示所有任务 |

### 11.5 删除标签
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 打开标签管理 Sheet | - |
| 2 | 点击标签旁的删除按钮 | 标签被删除 |
| 3 | 检查之前使用该标签的任务 | 标签徽章消失 |

---

## 十二、数据持久化验证

| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 执行各种操作后完全退出应用 | - |
| 2 | 重新打开应用 | 所有数据完整保留 |
| 3 | 检查数据文件 | `~/Library/Application Support/TodoTool/data.json` 存在 |

---

## 测试结果汇总

| 模块 | 测试项数 | 通过 | 失败 | 备注 |
|------|----------|------|------|------|
| 基础功能 | 4 | | | |
| 深色模式 | 4 | | | |
| 搜索过滤 | 5 | | | |
| 优先级标记 | 4 | | | |
| 导入/导出 | 3 | | | |
| 撤销/重做 | 6 | | | |
| 统计面板 | 4 | | | |
| 到期日期 | 5 | | | |
| 拖拽排序 | 4 | | | |
| 批量操作 | 3 | | | |
| 标签分类 | 5 | | | |
| 数据持久化 | 3 | | | |
| **总计** | **50** | | | |

---

## 快捷键速查表

| 快捷键 | 功能 |
|--------|------|
| ⌘N | 新建任务 |
| ⌘⌫ | 删除选中任务 |
| ⌘Enter | 切换完成状态 |
| ⌘F | 搜索 |
| ⌘E | 导出数据 |
| ⌘I | 导入数据 |
| ⌘Z | 撤销 |
| ⌘⇧Z | 重做 |
| ⌘⇧K | 清除已完成 |
| ⌘⇧T | 管理标签 |
| ⌘0/1/2/3 | 设置优先级（无/低/中/高） |
| Enter | 进入/确认编辑 |
| Esc | 取消编辑/清空搜索 |
| 双击 | 编辑任务标题 |

---

## 十二、任务描述与增强日期选择器

### 12.1 任务描述（多行）
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 新建任务，输入标题+多行描述（含换行） | 任务创建成功，描述完整保存在列表与 JSON 中 |
| 2 | 列表查看任务 | 描述在标题下方以次级字体显示，最多两行预览 |
| 3 | 行内编辑标题并修改描述后按 Enter | 标题和描述同时更新，弹出层关闭 |
| 4 | 行内编辑后按 Esc | 恢复原标题和描述，不保存修改 |

### 12.2 增强日期选择器
| 步骤 | 操作 | 预期结果 |
|------|------|----------|
| 1 | 点击任务行的日期区域（或右键菜单） | 打开 Popover，显示今天/明天/下周快捷按钮 + 日历 |
| 2 | 点击「今天」 | 任务日期设为今日 23:59:59，行内显示“今天” |
| 3 | 在日历选择自定义日期（跨月）并点击「确定」 | 日期设为所选日 23:59:59，行内显示对应日期 |
| 4 | 点击「清除」 | 到期日期移除，标签消失 |
| 5 | 在编辑模式下重复以上操作 | 日期更新后立刻刷新行显示，无崩溃 |

---

*测试文档版本: v1.1 | 更新时间: 2026-01-12*

